<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <style>
            .container {
                width: 100vw;
                height: 30vw;
                display: grid;
                margin: auto;
                grid-template-columns: 1fr 1fr 1fr;
                grid-template-rows: 1fr 1fr;
                grid-template-areas: 'g2 g3 g1' 'g2 g4 g1';
            }
            .area-g2 {
                grid-area: g2;
                margin: auto;
                font-size: 5vw;
            }

            .area-g3 {
                grid-area: g3;
                margin: auto;
                font-size: 5vw;
            }

            .area-g1 {
                grid-area: g1;
                margin: auto;
                font-size: 5vw;
            }

            .area-g4 {
                grid-area: g4;
                margin: auto;
                font-size: 5vw;
            }
        </style>
    </head>
    <body>
        <canvas id="field" width="400" height="400" style="border-color: rgb(0, 0, 0); border: 4px solid;"></canvas>

        <details>
            <summary>モバイル用ボタン</summary>
            <div class='container'>
                <div class='area-g2'>⬅</div>
                <div class='area-g3'>⬆</div>
                <div class='area-g4'>⬇</div>
                <div class='area-g1'>➡</div>
            </div>
        </details>

        <script>           
            window.onload = function() {
                const canvas = document.getElementById('field');
                const field = canvas.getContext('2d');
                
                //これらの変数に(キャラの)画像データを代入できるようにしておく
                const als_down = new Image();
                const als_up = new Image();
                const als_right = new Image();
                const als_left = new Image();
                
                //座標用の変数
                var x = (canvas.width - als_down.width) / 2;
                var y = (canvas.height - als_down.height) / 2;

                //画像読み込みが遅いのでここあらかじめ読み込んでおく
                als_down.src = "../img/als_down.png";
                als_up.src = "../img/als_up.png";
                als_right.src = "../img/als_right.png";
                als_left.src = "../img/als_left.png";
                
                //初期位置にキャラを配置
                field.drawImage(als_down, x, y);

                //入力したキー(↑,↓,→,←)を識別して、それぞれ押したときの処理を書く
                document.body.addEventListener('keydown',
                    event => {
                        switch (event.key) {
                            //↓キー押したときに動く
                            case 'ArrowDown':
                                //上で宣言した変数にキャラ画像を代入
                                als_down.src = "../img/als_down.png"
                                //Canvasを再描画する
                                field.clearRect(0, 0, canvas.width, canvas.height);
                                //座標の数値を更新して、キャラ画像を描画する
                                field.drawImage(als_down, x, y+=als_down.height);
                                break;
                        
                            //↑キー押したときに動く
                            case 'ArrowUp':
                                als_up.src = "../img/als_up.png"
                                field.clearRect(0, 0, canvas.width, canvas.height);
                                field.drawImage(als_up, x, y-=als_up.height);
                                break;

                            //→キー押したときに動く
                            case 'ArrowRight':
                                als_right.src = "../img/als_right.png"
                                field.clearRect(0, 0, canvas.width, canvas.height);
                                field.drawImage(als_right, x+=als_right.height, y);
                                break;
                            
                            //←キー押したときに動く
                            case 'ArrowLeft':
                                als_left.src = "../img/als_left.png"
                                field.clearRect(0, 0, canvas.width, canvas.height);
                                field.drawImage(als_left, x-=als_left.height, y);
                                break;
                        }
                    });
            };
        </script>
    </body>
</html>